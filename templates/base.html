{% load static i18n %}
<!doctype html>
<html lang="{{ LANGUAGE_CODE }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>

  {% block img %}
    <link rel="icon" type="image/jpg" sizes="32x32" href="{% static 'mini_logo.jpg' %}">
    <link rel="icon" type="image/jpg" sizes="16x16" href="{% static 'mini_logo.jpg' %}">
    <link rel="apple-touch-icon" href="{% static 'mini_logo.jpg' %}">
    <link rel="shortcut icon" href="{% static 'logo.jpg' %}">
  {% endblock img %}

  <title>{% block title %}–û–Ω–ª–∞–π–Ω –º–µ–Ω—é –°–∞–Ω–∂–∏{% endblock %}</title>

  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --text:#0f172a;
      --muted:#64748b;
      --line:rgba(255,255,255,.18);
      --shadow: 0 16px 50px rgba(0,0,0,.18);
      --radius: 22px;
    }

    html,body{ height:100%; }
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 20% 0%, rgba(255,255,255,.18), transparent 60%),
        radial-gradient(900px 500px at 90% 10%, rgba(255,255,255,.12), transparent 55%),
        linear-gradient(180deg, #FF7A00 0%, #FF6A00 55%, #FF5A00 100%) !important;
      background-attachment: fixed !important;
    }

    .wrap{ max-width:1120px; margin:0 auto; padding:14px; }

    .glass{
      background: rgba(255,255,255,.14);
      border: 1px solid rgba(255,255,255,.22);
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: var(--radius);
    }

    .brand{
      font-family:"Cormorant Garamond", serif;
      font-weight: 800;
      letter-spacing:.3px;
      font-size: 30px;
      line-height: 1;
      text-decoration:none;
      color: #fff;
      display:flex;
      align-items:center;
      gap:10px;
      white-space:nowrap;
    }

    .chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.10);
      color:#fff;
      text-decoration:none;
      font-weight: 800;
      transition: transform .12s ease, background .12s ease, box-shadow .12s ease;
    }
    .chip:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.14);
      box-shadow: 0 12px 26px rgba(0,0,0,.14);
    }

    .btn-lang{
      border:1px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.10);
      border-radius: 999px;
      padding:8px 12px;
      cursor:pointer;
      font-weight: 900;
      color:#fff;
      transition:.12s ease;
    }
    .btn-lang:hover{ background: rgba(255,255,255,.16); transform: translateY(-1px); }

    /* burger */
    .burger{
      width:44px; height:44px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.10);
      display:inline-flex;
      align-items:center; justify-content:center;
      gap:5px;
      cursor:pointer;
    }
    .burger span{ display:block; width:18px; height:2px; background:#fff; border-radius:2px; }

    .nav-links{ display:flex; gap:10px; align-items:center; }
    @media (max-width: 820px){
      .nav-links{ display:none; }
    }

    /* Drawer */
    .drawer{ position:fixed; inset:0; display:none; z-index:9999; }
    .drawer.open{ display:block; }
    .drawer .backdrop{ position:absolute; inset:0; background:rgba(0,0,0,.35); }
    .drawer .panel{
      position:absolute; inset:0;
      background:#fff;
      padding:18px 16px;
      display:flex;
      flex-direction:column;
    }
    .drawer .top{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .drawer .title{ font-weight: 900; font-size: 22px; }
    .drawer .close{
      width:44px;height:44px;
      border-radius:16px;
      border:1px solid rgba(15,23,42,.12);
      background:#fff;
      cursor:pointer;
      font-size:18px;
    }
    .drawer .links{
      margin-top:18px;
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .drawer .link{
      text-decoration:none;
      color:#0f172a;
      font-weight: 900;
      font-size: 20px;
      padding: 14px 14px;
      border-radius: 18px;
      border: 1px solid rgba(15,23,42,.10);
      background:#fff;
    }

    /* Footer */
    .footer-wrap{
      margin-top: 18px;
      padding: 18px;
    }
    .footer-title{
      font-weight: 1000;
      font-size: 18px;
      color:#fff;
      letter-spacing:.2px;
    }
    .footer-text{ color: rgba(255,255,255,.86); font-size: 13px; }
    .footer-link{ color:#fff; text-decoration:none; font-weight:900; }
    .footer-link:hover{ text-decoration: underline; }

    .cta-btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding: 12px 14px;
      border-radius: 16px;
      font-weight: 900;
      text-decoration:none;
      border:1px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.10);
      color:#fff;
      transition:.12s ease;
    }
    .cta-btn:hover{ background: rgba(255,255,255,.16); transform: translateY(-1px); }

    .cta-wa{ background:#25D366; border-color: rgba(255,255,255,.15); }
    .cta-wa:hover{ background:#20BE5B; }

    .cta-ig{ background: rgba(168, 4, 183, 0.82); border-color: rgba(255,255,255,.15); }
    .cta-ig:hover{ background: rgba(168, 4, 183, 0.92); }
  </style>

  {% block head_extra %}{% endblock %}
</head>

<body>

  <div class="wrap">

    <!-- ===== –∫—Ä–∞—Å–∏–≤—ã–π HEADER ===== -->
    <header class="glass px-4 py-4 md:px-5 md:py-5">
      <div class="flex items-center justify-between gap-3">

        <!-- left: brand + branch avatar -->
        <a class="brand" href="{% url 'public_site:home' %}">
          {% if branch and branch.cover_photo %}
            <img src="{{ branch.cover_photo.url }}"
                 alt="{{ branch.name }}"
                 class="w-10 h-10 rounded-full object-cover ring-2 ring-white/35 shadow-md">
          {% else %}
            <img src="{% static 'mini_logo.jpg' %}"
                 alt="Sanji"
                 class="w-10 h-10 rounded-full object-cover ring-2 ring-white/35 shadow-md">
          {% endif %}
          <span>–°–∞–Ω–∂–∏</span>
        </a>

        <!-- desktop nav -->
        <nav class="nav-links">
          {% if branch %}
            <a class="chip" href="{% url 'public_site:reservation' branch.id %}">üìÖ {% trans "–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ" %}</a>
          {% endif %}
          <a class="chip" href="{% url 'public_site:about' %}"> {% trans "–û –Ω–∞—Å" %}</a>

          {% if branch and branch.phone %}
            <a class="chip" href="tel:{{ branch.phone }}">üìû {% trans "–ü–æ–∑–≤–æ–Ω–∏—Ç—å" %}</a>
            <a class="chip" href="https://wa.me/{{ branch.phone|cut:'+'|cut:' ' }}"
               target="_blank" rel="noopener">üí¨ WhatsApp</a>
          {% endif %}
        </nav>

        <!-- right: langs + burger -->
        <div class="flex items-center gap-2">
          <form action="{% url 'set_language' %}" method="post" class="hidden md:flex items-center gap-2">
            {% csrf_token %}
            <input type="hidden" name="next" value="{{ request.path }}">
            <button class="btn-lang" type="submit" name="language" value="ru">RU</button>
            <button class="btn-lang" type="submit" name="language" value="ky">KY</button>
            <button class="btn-lang" type="submit" name="language" value="en">EN</button>
            <a href="{% url 'shops:store_list' %}">shops</a>
          </form>

          <button class="burger md:hidden" type="button" id="burgerBtn"
                  aria-label="Menu" aria-controls="drawer" aria-expanded="false">
            <span></span><span></span><span></span>
          </button>
        </div>

      </div>

      {% if branch %}
        <div class="mt-3 text-white/85 text-sm">
          <span class="font-extrabold">{{ branch.name }}</span>
          <span class="mx-2 opacity-50">‚Ä¢</span>
          <span>{{ branch.address }}</span>
        </div>
      {% endif %}
    </header>

    <!-- Drawer mobile -->
    <div class="drawer" id="drawer" aria-hidden="true">
      <div class="backdrop" data-close></div>
      <div class="panel" role="dialog" aria-modal="true">
        <div class="top">
          <div class="title">–°–∞–Ω–∂–∏</div>
          <button class="close" type="button" data-close aria-label="Close">‚úï</button>
        </div>

        <div class="links">
          {% if branch %}
            <a class="link" href="{% url 'public_site:reservation' branch.id %}">üìÖ {% trans "–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ" %}</a>
          {% endif %}
          <a class="link" href="{% url 'public_site:about' %}">‚ÑπÔ∏è {% trans "–û –Ω–∞—Å" %}</a>

          {% if branch and branch.phone %}
            <a class="link" href="tel:{{ branch.phone }}">üìû {% trans "–ü–æ–∑–≤–æ–Ω–∏—Ç—å" %}</a>
            <a class="link" target="_blank" rel="noopener"
               href="https://wa.me/{{ branch.phone|cut:'+'|cut:' ' }}">üí¨ WhatsApp</a>
          {% endif %}
        </div>

        <div class="mt-auto pt-4 border-t border-black/10">
          <div class="font-extrabold mb-2">–Ø–∑—ã–∫</div>
          <form action="{% url 'set_language' %}" method="post" class="flex gap-2 flex-wrap">
            {% csrf_token %}
            <input type="hidden" name="next" value="{{ request.path }}">
            <button class="btn-lang" type="submit" name="language" value="ru" style="color:#0f172a;border-color:rgba(15,23,42,.12);background:#fff;">RU</button>
            <button class="btn-lang" type="submit" name="language" value="ky" style="color:#0f172a;border-color:rgba(15,23,42,.12);background:#fff;">KY</button>
            <button class="btn-lang" type="submit" name="language" value="en" style="color:#0f172a;border-color:rgba(15,23,42,.12);background:#fff;">EN</button>
          </form>
        </div>
      </div>
    </div>

    <!-- ===== CONTENT ===== -->
    <main class="mt-4">
      {% block content %}{% endblock %}
    </main>

    <!-- ===== –∫—Ä–∞—Å–∏–≤—ã–π FOOTER ===== -->
    {% block footer %}
    <footer class="footer-wrap glass">
      <div class="grid gap-6 md:grid-cols-3 md:gap-10">

        <!-- CTA -->
        <div>
          <div class="footer-title">–°—Ç–∞–Ω—å –ø–∞—Ä—Ç–Ω—ë—Ä–æ–º –°–∞–Ω–∂–∏</div>
          <div class="footer-text mt-2">
            QR-–º–µ–Ω—é, –∑–∞–∫–∞–∑—ã —Å–æ —Å—Ç–æ–ª–∞, –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram.
            –ü–æ–¥–∫–ª—é—á–∏–º —Ä–µ—Å—Ç–æ—Ä–∞–Ω –±—ã—Å—Ç—Ä–æ.
          </div>

          <div class="mt-4 flex flex-wrap gap-2">
            <a class="cta-btn cta-wa" href="https://wa.me/996558212040" target="_blank" rel="noopener">üí¨ WhatsApp</a>
            <a class="cta-btn cta-ig" href="https://instagram.com/amantur555" target="_blank" rel="noopener">üì∑ Instagram</a>
          </div>

          <div class="footer-text mt-3">
            –ù–∞–ø–∏—à–∏ <b>‚Äú–ü–ê–†–¢–ù–Å–†‚Äù</b> ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—é —É—Å–ª–æ–≤–∏—è –∏ –¥–µ–º–æ.
          </div>
        </div>

        <!-- Links -->
        <div>
          <div class="footer-title">–†–∞–∑–¥–µ–ª—ã</div>
          <div class="mt-3 flex flex-col gap-2">
            <a class="footer-link" href="{% url 'public_site:home' %}">–ì–ª–∞–≤–Ω–∞—è</a>
            {% if branch %}
              <a class="footer-link" href="{% url 'public_site:reservation' branch.id %}">–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
            {% endif %}
            <a class="footer-link" href="{% url 'public_site:about' %}">–û –Ω–∞—Å</a>
          </div>
        </div>

        <!-- Contacts -->
        <div>
          <div class="footer-title">–ö–æ–Ω—Ç–∞–∫—Ç—ã</div>
          <div class="mt-3 footer-text">
            <div class="flex items-center gap-2"><span>üìç</span><span>–ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω</span></div>
            <div class="flex items-center gap-2 mt-2">
              <span>üìû</span>
              <a class="footer-link" href="https://wa.me/996558212040" target="_blank" rel="noopener">
                +996 558 212 040
              </a>
            </div>
            <div class="flex items-center gap-2 mt-2">
              <span>üì∑</span>
              <a class="footer-link" href="https://instagram.com/amantur555" target="_blank" rel="noopener">
                @amantur555
              </a>
            </div>
          </div>

          <div class="mt-4 p-4 rounded-2xl"
               style="background: rgba(0,0,0,.16); border:1px solid rgba(255,255,255,.18);">
            <div class="text-white font-extrabold">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∑–∞ 1 –¥–µ–Ω—å</div>
            <div class="footer-text mt-1">
              1) –ü–æ–ª—É—á–∞–µ–º –º–µ–Ω—é –∏ —Ü–µ–Ω—ã<br>
              2) –î–µ–ª–∞–µ–º QR-—Å—Ç–æ–ª—ã<br>
              3) –ü–æ–¥–∫–ª—é—á–∞–µ–º –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ<br>
              4) –ó–∞–ø—É—Å–∫–∞–µ–º
            </div>
          </div>
        </div>

      </div>

      <div class="mt-6 pt-4 flex flex-wrap items-center justify-between gap-2"
           style="border-top:1px solid rgba(255,255,255,.18);">
        <div class="footer-text">¬© {% now "Y" %} –°–∞–Ω–∂–∏ ‚Äî –æ–Ω–ª–∞–π–Ω –º–µ–Ω—é –∏ –∑–∞–∫–∞–∑—ã</div>
        <div class="footer-text">–°–¥–µ–ª–∞–Ω–æ –¥–ª—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ –ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω–∞ üá∞üá¨ ¬∑ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ Amantur Agency</div>
      </div>
    </footer>
    {% endblock footer %}

  </div>

  <script>
    (function(){
      const btn = document.getElementById('burgerBtn');
      const drawer = document.getElementById('drawer');
      if(!btn || !drawer) return;

      const open = () => {
        drawer.classList.add('open');
        drawer.setAttribute('aria-hidden', 'false');
        btn.setAttribute('aria-expanded', 'true');
        document.documentElement.style.overflow = 'hidden';
      };

      const close = () => {
        drawer.classList.remove('open');
        drawer.setAttribute('aria-hidden', 'true');
        btn.setAttribute('aria-expanded', 'false');
        document.documentElement.style.overflow = '';
      };

      btn.addEventListener('click', open);
      drawer.addEventListener('click', (e) => { if (e.target && e.target.closest('[data-close]')) close(); });
      drawer.querySelectorAll('a').forEach(a => a.addEventListener('click', close));
      document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && drawer.classList.contains('open')) close(); });
    })();
  </script>

</body>
</html>
