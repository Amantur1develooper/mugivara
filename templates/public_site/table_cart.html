{% extends "base.html" %}
{% load i18n %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 py-6">
  <div class="flex items-start justify-between gap-4">
    <div>
      <h1 class="text-2xl font-extrabold">{% trans "Корзина" %}</h1>
      <div class="text-stone-600 text-sm mt-1">
        {% trans "Стол:" %} <b>{{ place.title }}</b> · {{ branch.name_ru }}
      </div>
    </div>
    <a href="{% url 'table_menu' token %}"
       class="px-4 py-2 rounded-xl ring-1 ring-stone-200 hover:bg-stone-50">
      ← {% trans "Назад в меню" %}
    </a>
  </div>

  {% if messages %}
    <div class="mt-4 space-y-2">
      {% for m in messages %}
        <div class="rounded-xl p-3 ring-1 ring-stone-200 bg-white text-stone-800">{{ m }}</div>
      {% endfor %}
    </div>
  {% endif %}

  {% if qty_total == 0 %}
    <div class="mt-6 rounded-2xl bg-white ring-1 ring-stone-200 p-6">
      {% trans "Корзина пуста." %}
    </div>
  {% else %}
    <div class="mt-6 space-y-3">
      {% for r in rows %}
        <div class="rounded-2xl bg-white ring-1 ring-stone-200 p-4 flex items-center gap-4">
          <div class="flex-1">
            <div class="font-semibold">{{ r.branch_item.item.name_ru }}</div>
            <div class="text-sm text-stone-500 mt-1">{{ r.branch_item.price }} {% trans "сом" %}</div>
          </div>
          <div class="font-bold w-24 text-right">{{ r.qty }} ×</div>
          <div class="w-28 text-right font-extrabold">{{ r.line_total }} {% trans "сом" %}</div>
        </div>
      {% endfor %}
    </div>

    <div class="mt-6 rounded-2xl bg-white ring-1 ring-stone-200 p-5">
      <div class="flex justify-between text-lg font-extrabold">
        <span>{% trans "Итого" %}</span><span>{{ total }} {% trans "сом" %}</span>
      </div>
    </div>

    <div class="mt-6 rounded-2xl bg-white ring-1 ring-stone-200 p-5">
      <h2 class="text-xl font-extrabold">{% trans "Оформление" %}</h2>

      <form action="{% url 'table_checkout' token %}" method="post" class="mt-4 grid gap-3">
        {% csrf_token %}
        <input name="name" placeholder="{% trans 'Имя (необязательно)' %}"
               class="w-full border border-stone-300 rounded-xl px-3 py-2">
        <input name="phone" placeholder="{% trans 'Телефон (необязательно)' %}"
               class="w-full border border-stone-300 rounded-xl px-3 py-2">
        <textarea name="comment" rows="3" placeholder="{% trans 'Комментарий (необязательно)' %}"
                  class="w-full border border-stone-300 rounded-xl px-3 py-2"></textarea>

        <button class="mt-2 px-4 py-3 rounded-2xl bg-stone-900 text-white font-semibold shadow hover:bg-stone-800">
          {% trans "Отправить заказ на кухню" %}
        </button>
      </form>
    </div>
  {% endif %}
</div>
{% endblock %}
